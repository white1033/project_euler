# Problem 44: Pentagon Numbers

## Problem Description

Pentagonal numbers are generated by the formula, $P_n=n(3n-1)/2$. The first ten pentagonal numbers are:
$$1, 5, 12, 22, 35, 51, 70, 92, 117, 145, \dots$$

It can be seen that $P_4 + P_7 = 22 + 70 = 92 = P_8$. However, their difference, $70 - 22 = 48$, is not pentagonal.

Find the pair of pentagonal numbers, $P_j$ and $P_k$, for which their sum and difference are pentagonal and $D = |P_k - P_j|$ is minimised; what is the value of $D$?

## Analysis

We need to find $(P_j, P_k)$ such that:
1.  $P_k + P_j$ is pentagonal.
2.  $P_k - P_j$ is pentagonal.
3.  $D = P_k - P_j$ is minimised.

### Inverse Pentagonal Check
To check if a number $x$ is pentagonal in $O(1)$:
$$3n^2 - n - 2x = 0 \implies n = \frac{1 + \sqrt{1 + 24x}}{6}$$
$x$ is pentagonal if $\sqrt{1 + 24x}$ is an integer, say $R$, and $(1 + R) \pmod 6 \equiv 0$.

### Search Strategy (Correctness Guaranteed)

We can iterate through $k$ (generating $P_k$) and then iterate $j < k$ to check pairs. However, simply stopping at the first match might be incorrect if a later pair produces a smaller difference.

**Optimized Logic**:
1.  Iterate $k = 1, 2, \dots$
2.  Generate $P_k$.
3.  For each $k$, iterate $j$ from $k-1$ down to $1$ (checking $P_j$).
    *   Calculate $D = P_k - P_j$.
    *   If $D$ is pentagonal AND $P_k + P_j$ is pentagonal, we found a candidate solution $D_{candidate}$.
    *   Can we stop? Not necessarily immediately.
    
**Termination Condition**:
Let $D_{min}$ be the smallest difference found so far.
The smallest possible difference for any future $P_{k'}$ (where $k' > k$) is the gap between adjacent pentagonal numbers: $P_{k'} - P_{k'-1}$.
Gap formula: $G(n) = P_n - P_{n-1} = 3n - 2$.
Since $G(n)$ is strictly increasing, if $G(k+1) > D_{min}$, then no future pair can possibly have a difference smaller than $D_{min}$.
So we can safely terminate when $3(k+1) - 2 > D_{min}$.

## Solution

The solution implements the search with the rigorous termination condition to ensure the found difference is truly the global minimum.