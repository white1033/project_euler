# Problem 61: Cyclical Figurate Numbers

## Description

Triangle, square, pentagonal, hexagonal, heptagonal, and octagonal numbers are all figurate (polygonal) numbers and are generated by the following formulae:

| Type       | Formula            | First few terms       |
| :--------- | :----------------- | :-------------------- |
| Triangle   | $P_{3,n}=n(n+1)/2$ | 1, 3, 6, 10, 15, ...  |
| Square     | $P_{4,n}=n^2$      | 1, 4, 9, 16, 25, ...  |
| Pentagonal | $P_{5,n}=n(3n-1)/2$| 1, 5, 12, 22, 35, ... |
| Hexagonal  | $P_{6,n}=n(2n-1)$  | 1, 6, 15, 28, 45, ... |
| Heptagonal | $P_{7,n}=n(5n-3)/2$| 1, 7, 18, 34, 55, ... |
| Octagonal  | $P_{8,n}=n(3n-2)$  | 1, 8, 21, 40, 65, ... |

The ordered set of three 4-digit numbers: 8128, 2882, 8281, has three interesting properties:

1.  The set is cyclic, in that the last two digits of each number is the first two digits of the next (including the last number and the first). For example, 8128 $\to$ 2882 $\to$ 8281 $\to$ 8128.
2.  Each polygon type: triangle ($P_{3,127}=8128$), square ($P_{4,91}=8281$), and pentagonal ($P_{5,44}=2882$), is represented by a different number in the set.
3.  This is the only set of 4-digit numbers with this property.

Find the sum of the only ordered set of six cyclic 4-digit numbers for which each of the polygonal types: triangle, square, pentagonal, hexagonal, heptagonal, and octagonal, is represented by a different number in the set.

## Analysis

We need to find a cycle of 6 numbers, one from each polygonal type $P_3$ to $P_8$.

Let the set of numbers be $S = \{n_1, n_2, \dots, n_6\}$.
Each $n_i$ must be a 4-digit number.
Each $n_i$ corresponds to a unique polygonal type.
The cycle condition:
$n_1 \pmod{100} = \lfloor n_2 / 100 \rfloor$
$n_2 \pmod{100} = \lfloor n_3 / 100 \rfloor$
...
$n_6 \pmod{100} = \lfloor n_1 / 100 \rfloor$

Since $n_i$ must be a 4-digit number, the prefix $\lfloor n_i / 100 \rfloor$ must be at least 10. This implies that for any number in the chain, its last two digits must be $\ge 10$ (unless it's the end of the chain connecting to the start, but since all are 4-digits, all "connection points" must be $\ge 10$).

**Strategy:**
1.  Generate all 4-digit polygonal numbers for $P_3, \dots, P_8$. Store them grouped by type.
2.  Represent these numbers as nodes in a directed graph where an edge exists from $A$ to $B$ if $A \pmod{100} == \lfloor B / 100 \rfloor$.
3.  Since we need exactly one number from each type, we can use backtracking with state `(current_number, used_types)`.
4.  To optimize, we can fix the first type to be $P_8$ (since it has the fewest candidates) and search for a chain of length 6 that returns to the start condition.

The search depth is small (6), and the branching factor is limited by the matching digits constraint.